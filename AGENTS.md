## Problem Description

디지털 콘텐츠의 폭발적인 확장과 온라인 플랫폼의 광범위한 등장은 정보의 홍수를 초래한다. 스트리밍 플랫폼의 수많은 영화부터 온라인 쇼핑에 가득 찬 상품에 이르기까지, 사용자는 인간의 처리 능력을 초과하는 압도적인 양의 데이터에 직면한다. 추천 시스템은 이러한 정보 과부하 문제를 해결하기 위해 설계된 특화된 시스템으로 사람들의 일상에서 필수불가결한 존재가 되었으며, 방대한 정보의 바다에서 음악 트랙, 영화, 상품, 또는 소셜 매칭을 위한 효율적인 수단으로 작용한다. 

최근 그래프 신경망(GNN) 모델을 활용한 추천 시스템이 산업 응용 분야에서 주요 접근 방식으로 부상했는데, 이러한 모델은 추천 시스템의 정보를 그래프 관점에서 고려하며, 추천 데이터에 내재된 그래프 구조를 활용한다. 예를 들어, 추천 애플리케이션의 상호작용 데이터는 사용자와 항목을 노드로, 상호작용을 링크로 나타내는 그래프로 표현될 수 있다. GNN의 작동 방식은 노드 간의 엣지를 통해 메시지를 교환하고, 각 노드가 이 정보를 집계하여 자신을 업데이트하는 과정을 포함하고, 이 반복적인 프로세스를 통해 개별 노드는 다중 홉 이웃으로부터 통찰력을 축적하여 주변의 구조적 특징을 추론한다. 추천을 그래프 상의 작업으로 간주하는 것은 사용자 간의 사회적 관계나 항목이 공유하는 특성과 같은 구조적 정보를 통합할 때 특히 유리하다. 이러한 추천 시스템의 효과는 점점 더 많은 주요 기업들이 GNN을 추천 시스템에 통합하도록 촉진하고 있다.

주어진 dataset은 사용자와 영화 시청과 매칭에 대한 데이터이다. 
rating은 무시하기로 하지만, 고려해도 상관없다.

### 요구사항 1

Dataset의 특징을 면밀히 파악하고 여러 plan을 생각하라.
적절한 전처리를 수행하라.

### 요구사항 2

GNN 디자인하고 구현하라. 
학습을 위한 적절한 metrics를 선정하라. 
Train 파일들을 이용하여 학습시켜라.

### 요구사항 3

임의의 파일을 받아들여서 다음과 같이 추천 결과를 출력하도록 한다. 
(이 테스트할 test 파일은 아직은 없지만 성능을 평가할 땐 train 데이터를 split 해서 만든 임시의 test 데이터를 사용하기로 하고,
아래와같이 출력 테스트를 해볼 때는 sample2.csv를 사용하기로 함)

====================
user   item   recommend
1      166    O
4      88     X
...
====================
Total recommends = 123/200
Not recommend = 77/200


수업 중에 교수가 제공하는 파일을 test하여 나온 결과를 평가한다. 

모델로 저장해서 사용하도록 한다

## Q&A

Q1: 교수님 모델이 추천을 하게 된다면 딱 1개만 추천해서 그 추천이 맞는지를 확인하는것인지, 모델이 예를 들어 추천 ranking 중 10개의 추천 품목을 출력하면 거기에 포함되는지를 확인하는것인지 궁금합니다 
A1: 추천은 할수있는 만큼해도 됩니다. 단  잘못된 추천을 하면 감점됨

Q2: 안녕하세요 교수님. 테스트셋에는 train.csv에서 상호작용하지 않은 유저-아이템 쌍만 있는건지 질문드려도 될까요?
A2: 있을수있습니다

## 새로운 평가규칙

- topk 방법
- threshold 방법 
  
기존 선택 item 수에서 20% 이하 개수까지 아이템 추천
유저별로 추천해야할 아이템수가 다름

예를 들어
A 가 item 1~8 중 2 4 6 8 을 좋아한다, 그 중 50% 추가 추천이라면
1 3 5 7 중 2개 이하를 더 추천해야함

+ item 과 interaction이 10개 이하인 유저에 대해서는 무조건 2개 추천


## 작업 계획

버전 두개로 만들어 보고싶음

### A ver: 
- rating 컬럼의 존재 자체를 아예 무시하기
- user 과 item 의 존재 자체를 연결로 이해
- 연결이 없는 것 중 연결 만큼의 개수를 negative edge로 하고
- 나머지 positive, negative 모두 아닌 연결이 없는 것들에 대해서 binary classification 실행
- 

### B ver: 
- rating 값을 반영함
- rating 4를 기준으로 잡으면 4 보다 작은거, 4 이상 비율이 거의 50프로임
- 즉, 4 이하를 negative edge, 4 이상을 positive edge 로 보고 학습
- B ver 에서는 예상 rating 값을 맞추는 것임. 이 user-item 쌍은 rating이 몇일까?
- 그리고 맨처음에 rating 이 4 기준으로 했기에 예측한 rating 값이 4보다 낮을 경우 not recommend, 높을 경우 recommend 하도록

### 공통:
- 현재 존재하지 않는 user-item 쌍에 대해 추천을 하는 것 (B ver 에서 rating이 4보다 낮은 negative edge도 이미 있는 쌍임)
- 사실 user-item 값은 test 시 데이터로 주어질 예정 그 쌍에 대해 recommend 여부를 예측하는 것
- 